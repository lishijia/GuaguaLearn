<!--pages/study/index.wxml-->
<view class="study-container">
  <!-- å­¦ä¹ ä¸­ -->
  <block wx:if="{{!showFinish}}">
    <!-- é¡¶éƒ¨è¿›åº¦ -->
    <view class="study-header">
      <view class="progress-row">
        <text class="progress-text">{{mode === 'review' ? 'å¤ä¹ æ¨¡å¼' : 'å­¦ä¹ æ¨¡å¼'}}</text>
        <text class="progress-count">{{currentIndex + 1}} / {{words.length}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{(currentIndex + 1) / words.length * 100}}%"></view>
      </view>
    </view>

    <!-- å¡ç‰‡åŒºåŸŸ -->
    <view class="card-area">
      <view 
        class="card-wrapper {{isFlipped ? 'flipped' : ''}} {{swipeClass}}"
        bindtouchstart="onTouchStart"
        bindtouchmove="onTouchMove"
        bindtouchend="onTouchEnd"
        bindtap="flipCard"
      >
        <!-- æ­£é¢ -->
        <view class="card-face card-front">
          <text class="word-text">{{currentWord.word}}</text>
          <view class="phonetic-row">
            <text class="phonetic-text">{{currentWord.phonetic}}</text>
            <view class="sound-btn" catchtap="playSound">ğŸ”Š</view>
          </view>
          <text class="flip-hint">ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹é‡Šä¹‰ ğŸ‘†</text>
        </view>

        <!-- èƒŒé¢ -->
        <view class="card-face card-back">
          <view class="meaning-section">
            <text class="word-small">{{currentWord.word}}</text>
            <text class="meaning-text">{{currentWord.meaning}}</text>
          </view>
          <view class="example-section">
            <text class="example-label">ä¾‹å¥</text>
            <text class="example-text">{{currentWord.example}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ»‘åŠ¨æç¤º -->
    <view class="swipe-hints">
      <view class="hint-item">
        <text class="hint-icon">ğŸ‘ˆ</text>
        <text>ä¸è®¤è¯†</text>
      </view>
      <view class="hint-item">
        <text class="hint-icon">ğŸ‘†</text>
        <text>æ”¶è—</text>
      </view>
      <view class="hint-item">
        <text class="hint-icon">ğŸ‘‰</text>
        <text>è®¤è¯†</text>
      </view>
    </view>

    <!-- åº•éƒ¨æŒ‰é’® -->
    <view class="action-bar">
      <view class="action-btn btn-forget" bindtap="markForget">
        <text class="btn-icon">ğŸ¤”</text>
        <text>ä¸è®¤è¯†</text>
      </view>
      <view class="action-btn btn-favorite" bindtap="toggleFavorite">
        <text class="btn-icon">{{isFavorite ? 'â­' : 'â˜†'}}</text>
        <text>æ”¶è—</text>
      </view>
      <view class="action-btn btn-remember" bindtap="markRemember">
        <text class="btn-icon">ğŸ˜„</text>
        <text>è®¤è¯†</text>
      </view>
    </view>
  </block>

  <!-- å®Œæˆå¼¹çª— -->
  <view class="finish-overlay" wx:if="{{showFinish}}">
    <view class="finish-card animate-slideUp">
      <text class="finish-icon">ğŸ‰</text>
      <text class="finish-title">å­¦ä¹ å®Œæˆ!</text>
      <text class="finish-desc">æœ¬è½®å­¦ä¹ ç»Ÿè®¡</text>

      <view class="finish-stats">
        <view class="finish-stat">
          <text class="stat-value text-success">{{rememberCount}}</text>
          <text class="stat-label">è®¤è¯†</text>
        </view>
        <view class="finish-stat">
          <text class="stat-value text-error">{{forgetCount}}</text>
          <text class="stat-label">ä¸è®¤è¯†</text>
        </view>
        <view class="finish-stat">
          <text class="stat-value text-warning">{{favoriteCount}}</text>
          <text class="stat-label">å·²æ”¶è—</text>
        </view>
      </view>

      <view class="finish-actions">
        <button class="btn btn-primary" bindtap="goHome">è¿”å›é¦–é¡µ</button>
        <button class="btn btn-ghost" bindtap="continueStudy">ç»§ç»­å­¦ä¹ </button>
      </view>
    </view>
  </view>
</view>
