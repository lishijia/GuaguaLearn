<!--pages/progress/index.wxml-->
<view class="progress-container">
  <text class="page-title">å­¦ä¹ è¿›åº¦</text>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-grid">
    <view class="stat-card primary">
      <view class="stat-icon">ğŸ“š</view>
      <view class="stat-value">{{progress.totalLearned}}</view>
      <view class="stat-label">ç´¯è®¡å­¦ä¹ </view>
    </view>
    <view class="stat-card secondary">
      <view class="stat-icon">âœ…</view>
      <view class="stat-value">{{progress.totalMastered}}</view>
      <view class="stat-label">å·²æŒæ¡</view>
    </view>
    <view class="stat-card">
      <view class="stat-icon">ğŸ”¥</view>
      <view class="stat-value">{{streak}}</view>
      <view class="stat-label">è¿ç»­å¤©æ•°</view>
    </view>
    <view class="stat-card">
      <view class="stat-icon">ğŸ“Š</view>
      <view class="stat-value">{{progress.todayLearned}}</view>
      <view class="stat-label">ä»Šæ—¥å­¦ä¹ </view>
    </view>
  </view>

  <!-- å­¦ä¹ è¶‹åŠ¿å›¾ -->
  <view class="chart-section">
    <view class="section-header">
      <text class="section-title">å­¦ä¹ è¶‹åŠ¿</text>
      <view class="section-tab">
        <view class="tab-btn {{chartRange === 7 ? 'active' : ''}}" bindtap="setChartRange" data-range="7">7å¤©</view>
        <view class="tab-btn {{chartRange === 30 ? 'active' : ''}}" bindtap="setChartRange" data-range="30">30å¤©</view>
      </view>
    </view>
    <view class="bar-chart">
      <view class="bar-item" wx:for="{{chartData}}" wx:key="index">
        <view class="bar" style="height: {{item.height}}rpx"></view>
        <text class="bar-label">{{item.label}}</text>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ çƒ­åŠ›å›¾ -->
  <view class="chart-section">
    <view class="section-header">
      <text class="section-title">å­¦ä¹ æ—¥å†</text>
    </view>
    <view class="heatmap">
      <view 
        wx:for="{{heatmapData}}" 
        wx:key="index" 
        class="heat-cell level-{{item}}"
      ></view>
    </view>
    <view class="heatmap-legend">
      <text>å°‘</text>
      <view class="legend-item" style="background: var(--bg-tertiary)"></view>
      <view class="legend-item" style="background: rgba(14, 165, 233, 0.3)"></view>
      <view class="legend-item" style="background: rgba(14, 165, 233, 0.6)"></view>
      <view class="legend-item" style="background: var(--primary-color)"></view>
      <text>å¤š</text>
    </view>
  </view>

  <!-- è¯æ±‡æŒæ¡åˆ†å¸ƒ -->
  <view class="chart-section">
    <view class="section-header">
      <text class="section-title">è¯æ±‡æŒæ¡</text>
    </view>
    <view class="pie-section" style="--mastered: {{stats.mastered}}; --learning: {{stats.learning}}">
      <view class="pie-chart"></view>
      <view class="pie-legend">
        <view class="legend-row">
          <view class="legend-dot mastered"></view>
          <text class="legend-text">å·²æŒæ¡</text>
          <text class="legend-value">{{stats.mastered}}</text>
        </view>
        <view class="legend-row">
          <view class="legend-dot learning"></view>
          <text class="legend-text">å­¦ä¹ ä¸­</text>
          <text class="legend-value">{{stats.learning}}</text>
        </view>
        <view class="legend-row">
          <view class="legend-dot new"></view>
          <text class="legend-text">æœªå­¦ä¹ </text>
          <text class="legend-value">{{stats.new}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆå°±å¾½ç«  -->
  <view class="achievements-section">
    <view class="section-header">
      <text class="section-title">æˆå°±å¾½ç« </text>
    </view>
    <view class="badge-grid">
      <view 
        wx:for="{{achievements}}" 
        wx:key="id" 
        class="badge-item {{item.unlocked ? 'unlocked' : ''}}"
      >
        <view class="badge-icon">{{item.icon}}</view>
        <text class="badge-name">{{item.name}}</text>
      </view>
    </view>
  </view>
</view>
